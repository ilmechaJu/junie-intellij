# Task 06~10 실전 가이드라인 (guideline.md)

이 문서는 Task 06~10을 같은 저장소 안에서 일관된 방식으로 수행하기 위한 실행 가이드입니다. 각 Task는 고급 활용을 전제로 하며, 산출물 구조/체크리스트/평가 기준/추천 프롬프트를 포함합니다.

- 대상 독자: 본 저장소를 사용해 팀 개발 수준의 산출물을 목표로 하는 개인/소규모 팀
- 전제: Task 01~05를 통해 기본 사용 방법과 간단한 프로젝트 운영을 경험했다는 가정

---

## 공통 운영 규칙

- 브랜치 전략
  - main: 배포/완료된 결과물만 유지
  - feat/task-0X-<short-title>: 작업 브랜치
  - PR 머지 전 체크리스트와 자동화(테스트, 린트, 빌드) 통과 필수
- 버전/릴리즈
  - Task 단위로 태그 생성: v0X.0.0 (예: v06.0.0)
  - 릴리즈 노트에 사용자 영향, 마이그레이션, 롤백 포함
- 폴더 구조(권장)
  - /task06, /task07, ... /task10 각 폴더에 README.md와 관련 코드/스크립트/문서 배치
  - /docs 아래에 공통 문서(ADR, 아키텍처 다이어그램) 저장
- 문서 템플릿
  - ADR: docs/adr/ADR-YYYYMMDD-<title>.md
  - 변경 영향: docs/impact/IMPACT-<task>.md
  - 마이그레이션: docs/migrations/MIG-<id>.md
- 품질 기준(공통 루브릭)
  - 테스트 커버리지/성능 지표/보안 점수/가용성 지표 목표 설정 및 충족
  - 문서(ADR, 다이어그램, 변경 영향, 운영 절차) 포함
  - CI/CD 자동화로 코드/문서/테스트 동기화 검증

---

## 공통 체크리스트

- [ ] 문제 정의 및 성공 기준 명시(측정 가능한 지표 포함)
- [ ] ADR 1건 이상 작성 및 대안 비교
- [ ] 코드 변경에 대한 단위/통합/필요 시 e2e 테스트
- [ ] CI 파이프라인에서 빌드/테스트/린트 통과
- [ ] 보안/품질 스캔(가능 시) 수행 및 결과 기록
- [ ] 성능 영향(있다면) 측정 전/후 비교 공개
- [ ] 릴리즈 노트 작성 및 롤백 절차 문서화

---

## Junie 고급 활용 팁

- 역할 고정: "아키텍트 모드", "성능 엔지니어 모드", "보안 분석가 모드" 등
- 출력 제약: "Top-5 리스크만 표로", "시간 복잡도 O 표기 포함" 등
- 근거 요구: 가정/제약/트레이드오프를 표로 요구, ASCII 의존성 다이어그램 요청
- 반복 루프: 산출물 → 실행 결과 → 피드백 → 수정 제안 → 적용의 짧은 사이클 유지

---

## Task 06 — 레거시 모듈 리팩터링 & 회귀 테스트 자동화

- 목표: 복잡한 스파게티 코드를 모듈화하고, 회귀 방지 테스트를 자동화
- 산출물
  - 리팩터링 PR: 의존성 다이어그램(변경 전/후), 마이그레이션 노트, Deprecated 안내
  - 단위/통합 테스트(커버리지 80%+ 권장) 및 변경 영향 분석 문서
  - 회귀 테스트 워크플로우(예: GitHub Actions yml 예시)
- 디렉토리
  - /task06/README.md, /task06/diagrams/, /task06/tests/, /task06/ci/
- 체크리스트
  - [ ] 순환 의존 제거, 사이드이펙트 캡슐화, public API 축소/정리
  - [ ] Golden Test로 기존 동작 스냅샷 확보
  - [ ] Deprecated shim 및 호환성 레이어 제공(필요시)
- 진행 절차(예)
  1) 기존 모듈 의존 관계 수집 → 2) 핫스팟/사이클 파악 → 3) 인터페이스 분리/추상화 도입 → 4) 회귀 테스트 추가 → 5) 단계적 리팩터 → 6) CI 구성
- 추천 프롬프트
  - "이 모듈의 public API, 전역 상태, 순환 의존 경로를 요약하고, 끊는 전략(인터페이스 분리/이벤트 발행)을 변경 영향과 함께 제안해줘. 변경 전/후 의존성 다이어그램을 ASCII로 보여줘."
- 평가 기준
  - 커버리지 목표 달성, 사이클 제거, 린트/테스트/CI 통과, 마이그레이션 가이드 명확성

---

## Task 07 — Contract-first API(서버/클라이언트/계약 테스트)

- 목표: OpenAPI/AsyncAPI 스펙을 기준으로 서버 스텁, 클라이언트 SDK, 계약 테스트 구축
- 산출물
  - openapi.yaml 또는 asyncapi.yaml
  - 서버 구현(인증/인가, 에러 표준화 RFC 7807) + 타입 안전 클라이언트 SDK
  - Pact 또는 Schemathesis 기반 계약 테스트 파이프라인
- 디렉토리
  - /task07/spec/, /task07/server/, /task07/sdk/, /task07/tests-contract/
- 체크리스트
  - [ ] 스펙과 구현 drift 0
  - [ ] 표준화된 에러 응답과 재시도 정책 정의
  - [ ] 계약 테스트 CI 통과 및 샌드박스 예제 동작
- 진행 절차(예)
  1) 스펙 설계/주석 강화 → 2) 스텁 생성 → 3) 공통 에러 모델/예외 정책 → 4) SDK 생성 → 5) 계약 테스트 파이프라인 구성
- 추천 프롬프트
  - "이 OpenAPI 스펙을 바탕으로 공통 에러 모델과 재시도 정책을 정의해줘. 각 엔드포인트의 happy/edge/failure 케이스 계약 테스트 스크립트를 만들어줘."
- 평가 기준
  - 스펙-코드 동기화 검사 통과, SDK 예제 동작, 계약 테스트 CI 성공

---

## Task 08 — 성능 병목 탐지, 프로파일링, 알고리즘 개선

- 목표: 핫 패스를 식별하고 알고리즘/데이터 구조 개선, 전/후 성능 보고서 작성
- 산출물
  - 프로파일링 리포트(Top N hot path, GC/할당/락 대기)
  - 개선 PR(복잡도 분석, 메모리/CPU/레이턴시 차트)
  - 마이크로벤치마크/로드 테스트 스크립트
- 디렉토리
  - /task08/profile/, /task08/bench/, /task08/scripts/
- 체크리스트
  - [ ] p95/p99 레이턴시 개선 목표 달성
  - [ ] 메모리 피크 감소 및 회귀 없음
  - [ ] 재현 가능한 벤치마크 및 결과 문서화
- 진행 절차(예)
  1) 입력 분포/로그 분석 → 2) 프로파일링 → 3) 병목 후보 추정 → 4) 대안 알고리즘 비교 → 5) 변경 → 6) 성능 회귀 테스트 자동화
- 추천 프롬프트
  - "샘플 로그와 데이터 분포를 분석해 병목 지점을 추정하고, Trie vs HashMap 등 대안의 복잡도/메모리/캐시 친화성 트레이드오프를 표로 정리해줘."
- 평가 기준
  - 수치적 개선이 그래프로 증명되고, 회귀 방지 자동화가 존재

---

## Task 09 — 보안 하드닝: 위협 모델링, 정적/동적 분석, 시크릿 스캐닝

- 목표: 공격 표면 정리, 취약점 점검/완화, DevSecOps 체인 구성
- 산출물
  - 위협 모델링 문서(자산, 행위자, 공격 벡터, 우선순위)
  - SAST/DAST/Dependency Audit/Secret Scanning 파이프라인
  - 취약 패턴 제거 PR과 보안 가드레일(pre-commit 훅, 정책)
- 디렉토리
  - /task09/threat-model/, /task09/ci-security/, /task09/policies/
- 체크리스트
  - [ ] 입력 검증 강화 및 위험 경로 테스트
  - [ ] 취약 라이브러리 업데이트 및 호환성 검증
  - [ ] 시크릿 유출 방지 정책 적용
- 진행 절차(예)
  1) STRIDE 분류 기반 위협 모델링 → 2) 정적/동적 분석 도구 구성 → 3) 수정 PR → 4) 보안 가드레일 배치 → 5) 지속 모니터링
- 추천 프롬프트
  - "코드베이스에서 입력 검증이 약한 경로를 찾아 STRIDE 기준으로 위협을 분류하고, 각 항목별 완화책과 단위/통합 테스트 케이스를 생성해줘. pre-commit 훅 설정도 포함해줘."
- 평가 기준
  - 주요 취약점 제거, 파이프라인 경고 기준 설정, 정책 적용

---

## Task 10 — E2E 기능제공: 데이터모델→백엔드→프론트→관측성→릴리즈

- 목표: 현실적인 신규 기능을 설계부터 배포까지 E2E로 제공
- 산출물
  - ADR, 스키마/마이그레이션, 백엔드/프론트 코드, 스토리북/스크린샷
  - 테스트(단위/통합/e2e) + 관측성 대시보드(Alert 규칙)
  - CI/CD 파이프라인, 버전닝/체인지로그/릴리즈 노트, 롤백 플랜
- 디렉토리
  - /task10/backend/, /task10/frontend/, /task10/observability/, /task10/docs/
- 체크리스트
  - [ ] 장애 없는 마이그레이션/롤백 검증, 데이터 백필 스크립트
  - [ ] 품질 기준(SLO) 정의 및 준수
  - [ ] 사용자 영향/호환성 주의가 릴리즈 노트에 명확
- 진행 절차(예)
  1) Epic→Story→Task로 분해/RACI 작성 → 2) 스키마/마이그레이션 → 3) API/UI 구현 → 4) 테스트 전략 수립 및 실행 → 5) 관측성/알림 구성 → 6) 릴리즈/롤백 검증
- 추천 프롬프트
  - "이 기능을 Epic→Story→Task로 분해해 RACI와 리스크 레지스터를 만들어줘. 트렁크 기반 릴리즈 플로우, 롤백 시나리오, 데이터 백필 스크립트까지 제안해줘."
- 평가 기준
  - 배포/롤백이 재현 가능하고, 사용자 영향과 측정 가능한 SLO가 문서화

---

## 예시 CI 스니펫(GitHub Actions)

```yaml
name: ci
on: [push, pull_request]
jobs:
  build-test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-java@v4
        with:
          java-version: '21'
          distribution: 'temurin'
      - name: Build
        run: ./gradlew build --no-daemon
      - name: Test
        run: ./gradlew test --no-daemon
```

Windows/로컬에서는 다음 명령 예시를 사용하세요.
- Gradle 빌드: `gradlew.bat build`
- 테스트만: `gradlew.bat test`

---

## 문서 템플릿 샘플

### ADR 템플릿 요약
- Title: <의사결정 제목>
- Context: 배경/문제/제약
- Options: 대안 A/B/C (장단점)
- Decision: 선택/근거
- Consequences: 기술부채/리스크/마이그레이션

### PR 설명 템플릿 요약
- 목적/배경
- 주요 변경(코드/스키마/구성)
- 테스트(추가/수정/커버리지)
- 성능 영향
- 보안 영향
- 마이그레이션/롤백
- 스크린샷/다이어그램

### RFC 7807 에러 응답 예시(JSON)
```json
{
  "type": "https://example.com/probs/invalid-input",
  "title": "Invalid input",
  "status": 400,
  "detail": "name must not be blank",
  "instance": "/api/v1/items/123"
}
```

---

## 시작하기
1) 진행할 Task 디렉토리를 생성하고 README.md에 목표/지표/일정 작성
2) 본 가이드의 체크리스트와 템플릿을 복사하여 초기화
3) 작은 단위로 PR을 올리고, CI를 통해 검증 루프를 짧게 유지
4) 산출물(문서/다이어그램/스크립트)을 디렉토리 내에 함께 커밋

필요 시, 현재 레포/스택에 맞춘 더 구체적인 예제(파일 경로, 스크립트, 샘플 테스트)를 추가 제공할 수 있습니다.
