# 위협 모델(STRIDE 예시, 초보자 가이드)

이 문서는 STRIDE 방법을 이용해 서비스의 위협을 빠르게 파악하고 완화책을 정리하기 위한 템플릿입니다. 자신의 서비스에 맞게 항목을 수정하세요.

## 1. 자산(무엇을 지킬 것인가)
- 사용자 데이터(PII), 인증 토큰(JWT/세션), 로그(감사/접근), 구성 파일(.yml, 환경변수)

## 2. 행위자(누가 상호작용하는가)
- 합법 사용자(고객/관리자)
- 내부자(개발/운영)
- 외부 공격자(봇/스크립트/스캐너)
- 서드파티 시스템(결제/알림/SSO 등)

## 3. 데이터 흐름도(DFD)와 신뢰 경계(Trust Boundary)
초안 예시:
```
[인터넷 사용자]
  │
  ▼  (TB1)
[WAF/LB] ———→ [애플리케이션(API/Web)] ———→ (TB2) [Secrets Manager]
                      │                         └→ [외부 서드파티 API]
                      └——————————————→ [데이터베이스]
```
- TB1: 외부 → 경계 장비(WAF/LB) 진입 지점
- TB2: 애플리케이션 → 비밀/민감 데이터 저장소(Secrets/DB)

## 4. STRIDE 분류별 예시 위협
- S(위조): 약한 인증/세션 관리, 토큰 위조
- T(변조): 입력 검증 미흡으로 파라미터 변조, IDOR
- R(부인 방지): 감사 로깅/추적성 부재
- I(정보노출): 스택트레이스/디버그 정보 노출, 과한 에러 메시지
- D(서비스 거부): 레이트 리밋 부재, N+1 쿼리/비효율 연산 남용
- E(권한 상승): 수평/수직 권한 체크 누락

## 5. DFD 요소별 STRIDE 매핑(발췌)
| 요소 | 잠재 위협(STRIDE) | 영향도 | 현재 통제 | 추가 통제 |
|---|---|---|---|---|
| 사용자→App(API 입력) | S/T/I/D/E | 높음 | 인증, 기본 검증 | JSON 스키마 검증, 레이트리밋, WAF 룰, 표준 에러 모델 |
| App→DB | T/E | 중간 | ORM/프리페어 쿼리 | 최소권한 계정, RLS/행 수준 권한, 감사 로깅 |
| App→Secrets | S/E | 높음 | 비밀 관리자 사용 | 런타임 권한 최소화, 접근 감사, 키 로테이션 |

## 6. 우선순위 및 완화(Quick Wins)
- 고: 입력 검증 강화, 표준 에러 모델 도입, 속도 제한, 토큰 보호/만료, 강력한 세션 관리
- 중: 의존성 취약점 업데이트, 보안 헤더(CSP/HSTS/XCTO) 설정
- 저: 로깅/모니터링 보강, 운영 경보/대시보드 구성

## 7. 오남용/악용 시나리오(Abuse Cases)
- 무차별 대입/크리덴셜 스터핑 → 레이트리밋/캡차, 로그인 실패 알림
- 상세 에러 기반 정보수집 → 표준 에러 응답, 민감정보 마스킹
- 권한검증 우회(리소스 ID 변경) → 인가 미들웨어/정책 기반 체크, 리소스 소유권 검증

## 8. 테스트 제안(어떻게 검증할까)
- 단위/통합: 유효성 검사 실패 케이스(XSS/SQLi/경로 조작/SSRF) 포함
- 보안 헤더: 응답 헤더 존재/값 테스트(CSP, X-Content-Type-Options, HSTS 등)
- DAST: ZAP Baseline으로 기본 취약점 스캔(report 첨부)

## 9. 완료 기준(체크리스트 연계)
- SAST/DAST High/Critical 0개(또는 예외 문서화)
- 취약 의존성 0개 + SBOM 생성(CycloneDX)
- 시크릿 스캔(gitleaks) 파이프라인 통과 및 로컬 훅 설치
